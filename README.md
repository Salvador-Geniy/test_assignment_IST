# Тестовое задание для компании Инскултех. 

## Описание проекта
Данный проект реализован согласно тех.заданию. Написан на языке python, 
с использованием фреймворков django, django rest framework.
Базы данных - postgres, redis(используется для кэширования данных).
Упакован в docker.

### Что сделано

#### Основа
Модели проекта написаны и связаны так, как указано в задании, в схеме базы данных,
за одним исключением: поля 'is_active', 'created_at', 'updated_at' 
вынесены в отдельную модель 'status'(тип связи "один к одному"), чтобы избежать многократных повторений кода. 

Для каждого нового объекта необходимо создавать и объект status. Возможна также реализация автоматического
создания объекта status при сохранении основного объекта.

#### Аpi-эндпоинт
Реализован единственный api-эндпоинт для получения результатов исследований:<br>
http://localhost:8000/results/, который возвращает данные в формате json. 
Доступ к api-эндпоинту имеют только авторизованные пользователи. 

Аутентификация, а также регистрация новых пользователей доступна встроенными средствами
фреймворка django через админ-панель.

#### Кэширование
Дополнительно реализовано кэширование. При больших объемах информации, сохраненной в базе данных, 
оно существенно снизит нагрузку и количество запросов. В данный момент в кэш сохраняется только вычисленное общее
количество проведенных исследований(для тестов работоспособности). Разместить там любые
данные не составит труда.

#### Оптимизация
Проведена оптимизация запросов к базе данных: на данный момент количество запросов для получения всей 
информации равно двум.

#### Тесты
Написаны функциональные тесты.<br>
Библиотека coverage способна оценить работу тестов, покрытие кода.

Команды для создания отчета:<br>
- docker-compose run --rm web-app sh -c "coverage run --source='.' manage.py test ./lab_app/tests/"
- docker-compose run --rm web-app sh -c "coverage report"
- docker-compose run --rm web-app sh -c "coverage html" 

В итоге будет создана папка 'htmlcov'. Информация о результатах тестов содержится в файле 'htmlcov/index.html'. 
Для просмотра, его необходимо открыть в браузере.



## Установка и запуск

1. Установить Docker Desktop, если не установлен:
    https://docs.docker.com/desktop/install/
2. Установить git, если не установлен<br>
    https://git-scm.com/book/en/v2/Getting-Started-Installing-Git
3. Создать папку для проекта и перейти в нее.
4. Клонировать репозиторий:<br>
    выполнить команду в терминале<br>
    git clone https://github.com/Salvador-Geniy/test_assignment_IST.git
5. Перейти в корневую папку проекта:<br>
    cd test_assignment_IST/
6. Для сборки контейнера выполнить команду:<br>
docker-compose build
7. В файле test_assignment/service/service/settings.py  
в строке 'ALLOWED_HOSTS' прописать IP-адрес 'localhost'(например)
8. Команда для запуска:<br>
docker-compose up
9. Выполнить миграции для создания таблиц в базе данных:<br>
docker-compose run --rm web-app sh -c "python manage.py migrate"
10. Создать суперпользователя:<br>
docker-compose run --rm web-app sh -c "python manage.py createsuperuser"

    
В итоге будут доступны:

http://localhost:8000/admin/ - админ-панель

http://localhost:8000/results/ - результаты исследований

![Alt text](/example_results.PNG?raw=true "Optional Title")